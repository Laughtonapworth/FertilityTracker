<!-- Updated full HTML with mood and sex chart support and corrected icon date handling -->

<!-- Rest of the content remains unchanged -->

<div class="chart-container">
  <h2>Mood Timeline</h2>
  <canvas id="moodChart"></canvas>
</div>

<div class="chart-container">
  <h2>Sex Activity</h2>
  <canvas id="sexChart"></canvas>
</div>

<script>
  // Helper function to format date as YYYY-MM-DD
  function formatDateLocal(date) {
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
  }

  // Inside renderCharts function (append this at the end of renderCharts)
  const moodLabels = [], moodValues = [];
  const moodColors = { Happy: '#ffd700', Calm: '#87cefa', Low: '#ff6b6b', Irritable: '#ffa07a' };
  entries.forEach(e => {
    const dateKey = formatDateLocal(new Date(e.entryDate));
    if (e.mood) {
      moodLabels.push(dateKey);
      moodValues.push(e.mood);
    }
  });
  new Chart(document.getElementById("moodChart"), {
    type: 'bar',
    data: {
      labels: moodLabels,
      datasets: [{
        label: 'Mood',
        data: moodLabels.map(() => 1),
        backgroundColor: moodValues.map(m => moodColors[m] || '#ccc')
      }]
    },
    options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { display: false } } }
  });

  const sexLabels = [], sexValues = [];
  entries.forEach(e => {
    const dateKey = formatDateLocal(new Date(e.entryDate));
    sexLabels.push(dateKey);
    sexValues.push((e.sex || '').toLowerCase() === 'yes' ? 1 : 0);
  });
  new Chart(document.getElementById("sexChart"), {
    type: 'bar',
    data: {
      labels: sexLabels,
      datasets: [{ label: 'Sex Logged', data: sexValues, backgroundColor: '#f67280' }]
    },
    options: { responsive: true, scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } } }
  });
</script>

