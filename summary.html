const moodOptions = ['Calm', 'Happy', 'Irritable', 'Low'];
const moodCounts = moodOptions.reduce((acc, mood) => {
  acc[mood] = 0;
  return acc;
}, {});

cycle.forEach(e => {
  const mood = (e.mood || '').trim();
  if (moodOptions.includes(mood)) {
    moodCounts[mood]++;
  }
});

if (moodChartInstance) moodChartInstance.destroy();
moodChartInstance = new Chart(document.getElementById("moodChart"), {
  type: 'bar',
  data: {
    labels: moodOptions,
    datasets: [{
      label: 'Mood Entries',
      data: moodOptions.map(mood => moodCounts[mood]),
      backgroundColor: '#ffd166'
    }]
  },
  options: {
    responsive: true,
    scales: {
      y: { beginAtZero: true },
      x: {
        ticks: {
          autoSkip: false,
          maxRotation: 30,
          minRotation: 0
        }
      }
    }
  }
});

